"use strict";(self.webpackChunkreact_native_reanimated_docs=self.webpackChunkreact_native_reanimated_docs||[]).push([[8694],{15680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),u=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(s.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=u(t),m=r,y=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return t?a.createElement(y,l(l({ref:n},c),{},{components:t})):a.createElement(y,l({ref:n},c))}));function y(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=m;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o[d]="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=t[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},17728:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>O,contentTitle:()=>R,default:()=>j,frontMatter:()=>N,metadata:()=>x,toc:()=>P});var a=t(58168),r=t(96540),i=t(15680),l=t(9176),o=t(78506),s=t(80101),u=t(91691),c=t(78786),d=t(50014),p=t(27979),m=t(13508),y=t(11378),g=t(46096),f=t(92220);const h={code:"function anonymous(){const{width}=this.__closure;return width.value;}"},v={code:"function anonymous(){const{measure,animatedRef,runOnJS,setText}=this.__closure;const measurement=measure(animatedRef);if(measurement!==null){const measuredWidth=parseInt(measurement.width,10);runOnJS(setText)(measuredWidth);}}"};function b(){const e=(0,c.a)(),n=(0,d.U)(100),[t,a]=r.useState(n.value);return(0,m.i)(function(){const e=()=>n.value;return e.__closure={width:n},e.__workletHash=8144979773625,e.__initData=h,e}(),function(){const n=function(){const n=(0,y.x)(e);if(null!==n){const e=parseInt(n.width,10);(0,g.OG)(a)(e)}};return n.__closure={measure:y.x,animatedRef:e,runOnJS:g.OG,setText:a},n.__workletHash=1904413803809,n.__initData=v,n}()),r.createElement(l.A,{style:w.container},r.createElement(f.X,{ref:e,style:{...w.box,width:n}}),r.createElement(o.A,{style:w.label},"width: ",t),r.createElement(s.A,{onPress:()=>{n.value=(0,p.e)(n.value+50)},title:"Click me"}))}const w=u.A.create({container:{flex:1,alignItems:"center"},box:{height:100,backgroundColor:"#b58df1",borderRadius:20},label:{fontSize:24,marginVertical:16,color:"#b58df1"}}),A="import React from 'react';\nimport { Button, StyleSheet, View, Text } from 'react-native';\nimport Animated, {\n  measure,\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedRef,\n  useSharedValue,\n  withSpring,\n} from 'react-native-reanimated';\n\nexport default function App() {\n  const animatedRef = useAnimatedRef();\n  const width = useSharedValue(100);\n  const [text, setText] = React.useState(width.value);\n\n  const handlePress = () => {\n    width.value = withSpring(width.value + 50);\n  };\n\n  // highlight-start\n  useAnimatedReaction(\n    () => width.value,\n    () => {\n      const measurement = measure(animatedRef);\n\n      if (measurement !== null) {\n        const measuredWidth = parseInt(measurement.width, 10);\n        runOnJS(setText)(measuredWidth);\n      }\n    }\n  );\n  // highlight-end\n\n  return (\n    <View style={styles.container}>\n      <Animated.View ref={animatedRef} style={{ ...styles.box, width }} />\n      <Text style={styles.label}>width: {text}</Text>\n      <Button onPress={handlePress} title=\"Click me\" />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  box: {\n    height: 100,\n    backgroundColor: '#b58df1',\n    borderRadius: 20,\n  },\n  label: {\n    fontSize: 24,\n    marginVertical: 16,\n    color: '#b58df1',\n  },\n});\n",N={sidebar_position:2},R="useAnimatedReaction",x={unversionedId:"advanced/useAnimatedReaction",id:"advanced/useAnimatedReaction",title:"useAnimatedReaction",description:"useAnimatedReaction allows you to respond to changes in a shared value. It's especially useful when comparing values previously stored in the shared value with the current one.",source:"@site/docs/advanced/useAnimatedReaction.mdx",sourceDirName:"advanced",slug:"/advanced/useAnimatedReaction",permalink:"/react-native-reanimated/docs/advanced/useAnimatedReaction",draft:!1,editUrl:"https://github.com/software-mansion/react-native-reanimated/tree/main/docs/docs/advanced/useAnimatedReaction.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"measure",permalink:"/react-native-reanimated/docs/advanced/measure"},next:{title:"useFrameCallback",permalink:"/react-native-reanimated/docs/advanced/useFrameCallback"}},O={},P=[{value:"Reference",id:"reference",level:2},{value:"Arguments",id:"arguments",level:3},{value:"<code>prepare</code>",id:"prepare",level:4},{value:"<code>react</code>",id:"react",level:4},{value:"<code>dependencies</code> <Optional/>",id:"dependencies-",level:4},{value:"Returns",id:"returns",level:3},{value:"Example",id:"example",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Platform compatibility",id:"platform-compatibility",level:2}],C=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.yg)("div",n)},T=C("Optional"),S=C("InteractiveExample"),k=C("Indent"),E={toc:P},_="wrapper";function j(e){let{components:n,...t}=e;return(0,i.yg)(_,(0,a.A)({},E,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"useanimatedreaction"},"useAnimatedReaction"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"useAnimatedReaction")," allows you to respond to changes in a ",(0,i.yg)("a",{parentName:"p",href:"/docs/fundamentals/glossary#shared-value"},"shared value"),". It's especially useful when comparing values previously stored in the shared value with the current one."),(0,i.yg)("h2",{id:"reference"},"Reference"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-javascript"},"import { useAnimatedReaction } from 'react-native-reanimated';\n\nfunction App() {\n  useAnimatedReaction(\n    () => {\n      return sv.value;\n    },\n    (currentValue, previousValue) => {\n      if (currentValue !== previousValue) {\n        // do something \u2728\n      }\n    }\n  );\n\n  // ...\n}\n")),(0,i.yg)("details",null,(0,i.yg)("summary",null,"Type definitions"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-typescript"},"type DependencyList = ReadonlyArray<any>;\n\nfunction useAnimatedReaction<T>(\n  prepare: () => T,\n  react: (prepareResult: T, preparePreviousResult: T | null) => void,\n  dependencies?: DependencyList\n): void;\n"))),(0,i.yg)("h3",{id:"arguments"},"Arguments"),(0,i.yg)("h4",{id:"prepare"},(0,i.yg)("inlineCode",{parentName:"h4"},"prepare")),(0,i.yg)("p",null,"A function that should return a value to which you'd like to react. The value returned from this function is used as the first parameter of the ",(0,i.yg)("inlineCode",{parentName:"p"},"react")," argument."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-jsx"},"function App() {\n  useAnimatedReaction(\n    // highlight-start\n    () => {\n      return Math.floor(sv.value);\n    },\n    // highlight-end\n    (currentValue, previousValue) => {\n      // ...\n    }\n  );\n}\n")),(0,i.yg)("h4",{id:"react"},(0,i.yg)("inlineCode",{parentName:"h4"},"react")),(0,i.yg)("p",null,"A function that reacts to changes in the value returned by the ",(0,i.yg)("inlineCode",{parentName:"p"},"prepare")," function. The ",(0,i.yg)("inlineCode",{parentName:"p"},"react")," function has two parameters: the current value from the ",(0,i.yg)("inlineCode",{parentName:"p"},"prepare")," function and the previous value, which is initially set to ",(0,i.yg)("inlineCode",{parentName:"p"},"null"),"."),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-jsx"},"function App() {\n  useAnimatedReaction(\n    () => {\n      return Math.floor(sv.value);\n    },\n    // highlight-next-line\n    (currentValue, previousValue) => {\n      // ...\n      // highlight-next-line\n    }\n  );\n}\n")),(0,i.yg)("h4",{id:"dependencies-"},(0,i.yg)("inlineCode",{parentName:"h4"},"dependencies")," ",(0,i.yg)(T,{mdxType:"Optional"})),(0,i.yg)("p",null,"An optional array of dependencies."),(0,i.yg)("p",null,"Only relevant when using Reanimated ",(0,i.yg)("a",{parentName:"p",href:"https://docs.swmansion.com/react-native-reanimated/docs/guides/web-support#web-without-the-babel-plugin"},"without the Babel plugin on the Web"),"."),(0,i.yg)("h3",{id:"returns"},"Returns"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"useAnimatedReaction")," returns ",(0,i.yg)("inlineCode",{parentName:"p"},"undefined"),"."),(0,i.yg)("h2",{id:"example"},"Example"),(0,i.yg)(S,{src:A,component:(0,i.yg)(b,{mdxType:"AnimatedReactionMeasure"}),mdxType:"InteractiveExample"}),(0,i.yg)("h2",{id:"remarks"},"Remarks"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Ensure you do not mutate the same shared value in the ",(0,i.yg)("inlineCode",{parentName:"li"},"result")," function that you've used in the ",(0,i.yg)("inlineCode",{parentName:"li"},"prepare")," function, as this will lead to an infinite loop.")),(0,i.yg)(k,{mdxType:"Indent"},(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-jsx"},"function App() {\n  useAnimatedReaction(\n    () => {\n      // highlight-next-line\n      return width.value;\n    },\n    (currentValue) => {\n      // \ud83d\udea8 An infinite loop!\n      // highlight-next-line\n      width.value += currentValue;\n    }\n  );\n}\n"))),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"Callbacks passed to the ",(0,i.yg)("inlineCode",{parentName:"p"},"prepare")," and ",(0,i.yg)("inlineCode",{parentName:"p"},"result")," arguments are automatically ",(0,i.yg)("a",{parentName:"p",href:"/docs/fundamentals/glossary#to-workletize"},"workletized")," and run on the ",(0,i.yg)("a",{parentName:"p",href:"/docs/fundamentals/glossary#ui-thread"},"UI thread"),".")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("p",{parentName:"li"},"You can technically react to any stateful React value using ",(0,i.yg)("inlineCode",{parentName:"p"},"useAnimatedReaction")," but you should probably use a ",(0,i.yg)("inlineCode",{parentName:"p"},"useEffect")," for that instead."))),(0,i.yg)("h2",{id:"platform-compatibility"},"Platform compatibility"),(0,i.yg)("div",{className:"platform-compatibility"},(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Android"),(0,i.yg)("th",{parentName:"tr",align:null},"iOS"),(0,i.yg)("th",{parentName:"tr",align:null},"Web"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,i.yg)("td",{parentName:"tr",align:null},"\u2705"),(0,i.yg)("td",{parentName:"tr",align:null},"\u2705"))))))}j.isMDXComponent=!0},92220:(e,n,t)=>{t.d(n,{X:()=>r});var a=t(9176);const r=(0,t(72089).b)(a.A)},78786:(e,n,t)=>{t.d(n,{a:()=>m});var a=t(96540),r=t(50014),i=t(57659),l=t(30221),o=t(46038),s=t(4992),u=t(67862),c=t(38507);const d=(0,c.HZ)();function p(e){return(0,c.J2)()&&e.getNativeScrollRef?e.getNativeScrollRef():!(0,c.J2)()&&e.getScrollableNode?e.getScrollableNode():e}function m(){const e=(0,r.U)(-1),n=(0,r.U)(null),t=(0,a.useRef)();if(!t.current){const a=t=>{if(t){const l=(0,c.J2)()?i.t:s.A,o=()=>d?p(t):l(p(t));var r;if(e.value=o(),a.getTag=(0,c.J2)()?()=>(0,s.A)(p(t)):o,a.current=t,"ios"===u.A.OS&&!(0,c.J2)())n.value=(null==t||null===(r=t.viewConfig)||void 0===r?void 0:r.uiViewClassName)||"RCTView"}return e.value};a.current=null;const r=(0,l.jt)({__init:()=>{const t=()=>e.value;return t.viewName=n,t}});o.A.set(a,r),t.current=a}return t.current}},80101:(e,n,t)=>{t.d(n,{A:()=>v});var a=t(96540),r=t(91691),i=t(58168),l=t(98587),o=t(11804),s=t(17069),u=t(9176),c=["activeOpacity","delayPressIn","delayPressOut","delayLongPress","disabled","focusable","onLongPress","onPress","onPressIn","onPressOut","rejectResponderTermination","style"];function d(e,n){var t=e.activeOpacity,r=e.delayPressIn,d=e.delayPressOut,m=e.delayLongPress,y=e.disabled,g=e.focusable,f=e.onLongPress,h=e.onPress,v=e.onPressIn,b=e.onPressOut,w=e.rejectResponderTermination,A=e.style,N=(0,l.A)(e,c),R=(0,a.useRef)(null),x=(0,o.A)(n,R),O=(0,a.useState)("0s"),P=O[0],C=O[1],T=(0,a.useState)(null),S=T[0],k=T[1],E=(0,a.useCallback)(((e,n)=>{k(e),C(n?n/1e3+"s":"0s")}),[k,C]),_=(0,a.useCallback)((e=>{E(null!=t?t:.2,e)}),[t,E]),j=(0,a.useCallback)((e=>{E(null,e)}),[E]),D=(0,a.useMemo)((()=>({cancelable:!w,disabled:y,delayLongPress:m,delayPressStart:r,delayPressEnd:d,onLongPress:f,onPress:h,onPressStart(e){var n=null!=e.dispatchConfig?"onResponderGrant"===e.dispatchConfig.registrationName:"keydown"===e.type;_(n?0:150),null!=v&&v(e)},onPressEnd(e){j(250),null!=b&&b(e)}})),[m,r,d,y,f,h,v,b,w,_,j]),I=(0,s.A)(R,D);return a.createElement(u.A,(0,i.A)({},N,I,{accessibilityDisabled:y,focusable:!y&&!1!==g,pointerEvents:y?"none":void 0,ref:x,style:[p.root,!y&&p.actionable,A,null!=S&&{opacity:S},{transitionDuration:P}]}))}var p=r.A.create({root:{transitionProperty:"opacity",transitionDuration:"0.15s",userSelect:"none"},actionable:{cursor:"pointer",touchAction:"manipulation"}}),m=a.memo(a.forwardRef(d));m.displayName="TouchableOpacity";const y=m;var g=t(78506),f=a.forwardRef(((e,n)=>{var t=e.accessibilityLabel,r=e.color,i=e.disabled,l=e.onPress,o=e.testID,s=e.title;return a.createElement(y,{accessibilityLabel:t,accessibilityRole:"button",disabled:i,focusable:!i,onPress:l,ref:n,style:[h.button,r&&{backgroundColor:r},i&&h.buttonDisabled],testID:o},a.createElement(g.A,{style:[h.text,i&&h.textDisabled]},s))}));f.displayName="Button";var h=r.A.create({button:{backgroundColor:"#2196F3",borderRadius:2},text:{color:"#fff",fontWeight:"500",padding:8,textAlign:"center",textTransform:"uppercase"},buttonDisabled:{backgroundColor:"#dfdfdf"},textDisabled:{color:"#a1a1a1"}});const v=f}}]);